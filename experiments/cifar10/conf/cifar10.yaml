trainer:
    devices: -1
    accelerator: gpu
    max_epochs: -1
    accumulate_grad_batches: 16
    strategy: ddp

seed: 42
wandb:
    project: CIFAR10
    resume: True
    reinit: False

ema_callback:
    enabled: True
    decay: 0.9999
    cpu_offload: False
    every_n_steps: 1
    validate_original_weights: False

checkpoint_callback:
    monitor: train_loss 
    mode: min
    save_top_k: 1
    verbose: True

generate_callback:
    num_samples: 8
    img_shape: [3, 32, 32]
    every_n_epochs: 5

model:
    train_ds:
        batch_size: 128
        num_workers: 6

    optim:
        name: adamw
        lr: 0.0001
        weight_decay: 0.001
        
solver:
    _target_: tinyedm.DeterministicSolver
    num_steps: 18
    sigma_min: 0.002
    sigma_max: 80.0
    rho: 7.0
    dtype: float32

ema:
    enable: True
    decay: 0.999
    validate_original_weights: False
    cpu_offload: False
    every_n_steps: 1